<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>index</title>
</head>
<body>
    <div>
        <dl>
            <dt>
                test1
            </dt>
            <dd>
                <input type="text" value="test1" id="test1"/>
            </dd>
            <dt>
                test2
            </dt>
            <dd>
                <input type="text" value="test2" id="test2"/>
            </dd>
        </dl>
        <hr>
        <input type="button" value="createForm" onclick="createForm()"/>
        <dl id="test3">
        </dl>
        <dl>
            <dt>
                test4
            </dt>
            <dd>
                <input type="text" value="test4" id="test4"/>
            </dd>
        </dl>
        <input type="button" value="submit" onclick="moveSub()"/>
    </div>

    <script>
        window.addEventListener("DOMContentLoaded", function() {
            if(sessionStorage.getItem("sessionInfo") == null) {
                createForm();
            } else {
                var a = JSON.parse(sessionStorage.getItem("sessionInfo")).test3;
                for (i = 0; i < Object.keys(a).length; i++) {
                createForm();
                }
            }
        })


        function createForm() {
            var str = 
                `<dt>
                    test3
                </dt>
                <dd>
                    <input type="text" value="test3" class="test3"/>
                </dd>
                `;
            var elm = document.getElementById("test3");
            elm.insertAdjacentHTML("beforeend", str);
        }

        function moveSub() {
            var sessionInfo = {}
            sessionInfo.test1 = document.getElementById("test1").value;
            sessionInfo.test2 = document.getElementById("test2").value;
            sessionInfo.test4 = document.getElementById("test4").value;
            var obj = document.getElementsByClassName("test3");
            var test3obj = {};
            for (i = 0; i < obj.length; i++) {
                test3obj["test3_" + i] = obj[i].value;
            };
            sessionInfo.test3 = test3obj;
            sessionStorage.setItem("sessionInfo", JSON.stringify(sessionInfo));

            window.location.href = "sub.html";
        }
    </script>
</body>
</html>